<div class="bar-stable">
    <ion-header-bar class="bar-stable bar bar-header" align-title="center" ng-if="!medMapPresent">
        <button ui-sref="app.medicines" class="button back-button buttons button-clear header-item">
            <i class="flaticon-left-arrow"></i> 
            <span class="back-text">
                <div class="default-title medicine-search-title">Поиск препаратов</div>
                <span class="previous-title hide"></span>
            </span>
        </button>

        <button class="button header-right-button-1 buttons button-clear header-item" ng-click="openFilter()" ng-class="filterOpen ? 'filterOpen' : ''"><i class="flaticon-filter"></i> 
        </button>

        <button class="button header-right-button buttons button-clear header-item" ui-sref="app.myCart"><i class="flaticon-shopping-cart"></i> <span class="order-count"><span>{{shoppingCart.length}}</span></span>
        </button>
    </ion-header-bar> 
    
    <ion-header-bar class="bar-stable bar bar-header" align-title="center" ng-if="medMapPresent">
        <button ng-click="showMapMed()" class="button back-button buttons button-clear header-item" >
            <i class="flaticon-left-arrow"></i> 
            <span class="back-text">
                <div class="default-title medicine-search-title">Назад</div>
                <span class="previous-title hide"></span>
            </span>
        </button>
    </ion-header-bar>
</div>
<ion-view view-title="Search" animation="no-animation">
    <ion-content class="no-header">
        <div class="ma-results ma-my-cart">
            <div class="result-header-wrapper">
                <div class="ma-search-name">
                    <span>Корзина покупок<span ng-if="!shoppingCart.length"> пуста</span></span>
                </div>
            </div>
            
            
            <!--  MAP DIV TO SHOW THE PHARMACY LOCATION  -->
            <div class="medicineMapView" style="height:100%">
                <ng-map default-style="false" center="tashkent" zoom="12" style="height:100% !important; width:100%;">
                    <marker id="foo" position="{{cartMap}}" on-click="map.showInfoWindow(event, 'bar')">
                    </marker>
                    <!-- <marker position="current" animation="Animation.BOUNCE" centered="true"></marker>-->
                    <custom-marker id="can" position="current" on-click="click()">
                        <div>
                            <img src="img/map-icon.png" width="40" height="40" />
                        </div>
                    </custom-marker>
                    <info-window id="bar" max-width="200">
                        <div ng-non-bindable>
                            <div id="siteNotice"></div>
                            <div id="bodyContent">
                                <p>
                                    <b>{{clinicName}}</b>
                                </p>
                            </div>
                        </div>
                    </info-window>
                </ng-map>
            </div>
            <!-- END OF MAP SHOW   -->

            <div class="ma-results-wrapper">
                <div class="medicine-result" ng-repeat="cart in shoppingCart">
                    <div class="mr-top">
                        <img width="60" height="60" class="product-photo" ng-src="{{'http://medappteka.uz'+cart.med_photo}}" />
                        <div class="product-info">
                            <div>Препарат: <span>{{cart.med_name}} </span></div>
                            <div>Аптека: <span>{{cart.pharmacy_name}}</span></div>
                            <div>Адрес: <span>{{cart.pharmacy_address}} </span></div>
                        </div>
                    </div>                    
                    <div class="mr-bottom">
                        <ul>
                            <li class="button button-light map-button" ng-click="showMapMed(cart)"><i class="flaticon-placeholder" style="bottom:3px"></i> Kарта</li>
                            <li class="button button-positive call-button" ng-click="callFromCart(cart)"><i class="flaticon-call-answer" style="bottom:3px"></i> Позвонить </li>
                            <li class="button button-energized price-button">
                                {{cart.med_price | formatPrice}} <span class="sum">сум</span></li>
                        </ul>
                    </div>
                    <div class="list med-quantity">
                        <ion-item>
                            <div class="list">
                                <label class="item item-input item-select">
                                    <div class="input-label"> Выберите необходимое количество</div>
                                    <select ng-model="cart.count" class="quantity-select">
                                        <option value="1">1</option>
                                        <option value="2">2</option>
                                        <option value="3">4</option>
                                        <option value="5">5</option>
                                        <option value="6">6</option>
                                        <option value="7">7</option>
                                        <option value="8">8</option>
                                        <option value="9">9</option>
                                        <option value="10">10</option>
                                        <option value="11">11</option>
                                    </select>
                                </label>
                                <div class="cart-subtotal">
                                   <span>Под итог : </span> {{cart.med_price * cart.count | formatPrice}}
                                    <div class="remove-order" ng-click="removeFromCart($index)">Убрать</div>
                                </div>
                            </div>
                        </ion-item>
                    </div>
                </div>
                
                <div ng-if="shoppingCart.length" class="cart-total">Итого заказ на сумму: <span> {{getTotal()}} сум</span></div>
                <button ng-if="shoppingCart.length" class="proceed-checkout" ui-sref="app.checkout">Перейти к оформлению 
                    <i class="flaticon-right-arrow"></i>
                </button>
            </div>
        </div>
    </ion-content>
</ion-view>